
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Portfolio and learning journal of a machine learning enthusiast">
      
      
        <meta name="author" content="Muhammad Luqman Hakim">
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Linear Regression sklearn - ML Journey — Muhammad Luqman Hakim</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ML Journey — Muhammad Luqman Hakim" class="md-header__button md-logo" aria-label="ML Journey — Muhammad Luqman Hakim" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ML Journey — Muhammad Luqman Hakim
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Linear Regression sklearn
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../about/" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ML Journey — Muhammad Luqman Hakim" class="md-nav__button md-logo" aria-label="ML Journey — Muhammad Luqman Hakim" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ML Journey — Muhammad Luqman Hakim
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Linear Regression sklearn</h1>

<pre><code class="language-python">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import statsmodels.api as sm
</code></pre>
<pre><code class="language-python">from statsmodels.stats.outliers_influence \
     import variance_inflation_factor as VIF
from statsmodels.stats.anova import anova_lm

from ISLP import load_data
from ISLP.models import (ModelSpec as MS,
                         summarize,
                         poly)
</code></pre>
<pre><code class="language-python">df = pd.read_csv(&quot;../dataset/Auto.csv&quot;, na_values='?')
df = df.dropna()
df = df.iloc[20:,:]
df
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cylinders</th>
      <th>displacement</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>year</th>
      <th>origin</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>25.0</td>
      <td>4</td>
      <td>110.0</td>
      <td>87.0</td>
      <td>2672</td>
      <td>17.5</td>
      <td>70</td>
      <td>2</td>
      <td>peugeot 504</td>
    </tr>
    <tr>
      <th>21</th>
      <td>24.0</td>
      <td>4</td>
      <td>107.0</td>
      <td>90.0</td>
      <td>2430</td>
      <td>14.5</td>
      <td>70</td>
      <td>2</td>
      <td>audi 100 ls</td>
    </tr>
    <tr>
      <th>22</th>
      <td>25.0</td>
      <td>4</td>
      <td>104.0</td>
      <td>95.0</td>
      <td>2375</td>
      <td>17.5</td>
      <td>70</td>
      <td>2</td>
      <td>saab 99e</td>
    </tr>
    <tr>
      <th>23</th>
      <td>26.0</td>
      <td>4</td>
      <td>121.0</td>
      <td>113.0</td>
      <td>2234</td>
      <td>12.5</td>
      <td>70</td>
      <td>2</td>
      <td>bmw 2002</td>
    </tr>
    <tr>
      <th>24</th>
      <td>21.0</td>
      <td>6</td>
      <td>199.0</td>
      <td>90.0</td>
      <td>2648</td>
      <td>15.0</td>
      <td>70</td>
      <td>1</td>
      <td>amc gremlin</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>392</th>
      <td>27.0</td>
      <td>4</td>
      <td>140.0</td>
      <td>86.0</td>
      <td>2790</td>
      <td>15.6</td>
      <td>82</td>
      <td>1</td>
      <td>ford mustang gl</td>
    </tr>
    <tr>
      <th>393</th>
      <td>44.0</td>
      <td>4</td>
      <td>97.0</td>
      <td>52.0</td>
      <td>2130</td>
      <td>24.6</td>
      <td>82</td>
      <td>2</td>
      <td>vw pickup</td>
    </tr>
    <tr>
      <th>394</th>
      <td>32.0</td>
      <td>4</td>
      <td>135.0</td>
      <td>84.0</td>
      <td>2295</td>
      <td>11.6</td>
      <td>82</td>
      <td>1</td>
      <td>dodge rampage</td>
    </tr>
    <tr>
      <th>395</th>
      <td>28.0</td>
      <td>4</td>
      <td>120.0</td>
      <td>79.0</td>
      <td>2625</td>
      <td>18.6</td>
      <td>82</td>
      <td>1</td>
      <td>ford ranger</td>
    </tr>
    <tr>
      <th>396</th>
      <td>31.0</td>
      <td>4</td>
      <td>119.0</td>
      <td>82.0</td>
      <td>2720</td>
      <td>19.4</td>
      <td>82</td>
      <td>1</td>
      <td>chevy s-10</td>
    </tr>
  </tbody>
</table>
<p>372 rows × 9 columns</p>
</div>

<pre><code class="language-python">print(df.info())
print(df.describe())
</code></pre>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 392 entries, 0 to 396
Data columns (total 9 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   mpg           392 non-null    float64
 1   cylinders     392 non-null    int64  
 2   displacement  392 non-null    float64
 3   horsepower    392 non-null    float64
 4   weight        392 non-null    int64  
 5   acceleration  392 non-null    float64
 6   year          392 non-null    int64  
 7   origin        392 non-null    int64  
 8   name          392 non-null    object 
dtypes: float64(4), int64(4), object(1)
memory usage: 30.6+ KB
None
              mpg   cylinders  displacement  horsepower       weight  \
count  392.000000  392.000000    392.000000  392.000000   392.000000   
mean    23.445918    5.471939    194.411990  104.469388  2977.584184   
std      7.805007    1.705783    104.644004   38.491160   849.402560   
min      9.000000    3.000000     68.000000   46.000000  1613.000000   
25%     17.000000    4.000000    105.000000   75.000000  2225.250000   
50%     22.750000    4.000000    151.000000   93.500000  2803.500000   
75%     29.000000    8.000000    275.750000  126.000000  3614.750000   
max     46.600000    8.000000    455.000000  230.000000  5140.000000

       acceleration        year      origin  
count    392.000000  392.000000  392.000000  
mean      15.541327   75.979592    1.576531  
std        2.758864    3.683737    0.805518  
min        8.000000   70.000000    1.000000  
25%       13.775000   73.000000    1.000000  
50%       15.500000   76.000000    1.000000  
75%       17.025000   79.000000    2.000000  
max       24.800000   82.000000    3.000000
</code></pre>
<pre><code class="language-python">plt.scatter(df[&quot;horsepower&quot;], df[&quot;mpg&quot;])
</code></pre>
<pre><code>&lt;matplotlib.collections.PathCollection at 0x7482ad90a9c0&gt;
</code></pre>
<p><img alt="png" src="../Linear%20Regression%20sklearn_files/Linear%20Regression%20sklearn_4_1.png" /></p>
<pre><code class="language-python">X = pd.DataFrame({&quot;intercept&quot;: np.ones(df.shape[0]), &quot;horsepower&quot;: df[&quot;horsepower&quot;]})
X.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>intercept</th>
      <th>horsepower</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>1.0</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.0</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1.0</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1.0</td>
      <td>113.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1.0</td>
      <td>90.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">model = sm.OLS(df[&quot;mpg&quot;], X)
result = model.fit()
summarize(result)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>std err</th>
      <th>t</th>
      <th>P&gt;|t|</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>intercept</th>
      <td>41.1259</td>
      <td>0.758</td>
      <td>54.222</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>horsepower</th>
      <td>-0.1702</td>
      <td>0.007</td>
      <td>-24.281</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">result.params
</code></pre>
<pre><code>intercept     41.125860
horsepower    -0.170189
dtype: float64
</code></pre>
<pre><code class="language-python">fig, ax = plt.subplots()
ax.scatter(df[&quot;horsepower&quot;], df[&quot;mpg&quot;], s=5)

coef = result.params
xlim = ax.get_xlim()
ylim = (coef[0] + coef[1] * xlim[0], coef[0] + coef[1] * xlim[1])
ax.plot(xlim, ylim, 'r-')
ax.set_title(coef)
</code></pre>
<pre><code>/tmp/ipykernel_152811/4053741418.py:6: FutureWarning: Series.__getitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To access a value by position, use `ser.iloc[pos]`
  ylim = (coef[0] + coef[1] * xlim[0], coef[0] + coef[1] * xlim[1])

Text(0.5, 1.0, 'intercept     41.125860\nhorsepower    -0.170189\ndtype: float64')
</code></pre>
<p><img alt="png" src="../Linear%20Regression%20sklearn_files/Linear%20Regression%20sklearn_8_2.png" /></p>
<pre><code class="language-python"># confidence interval
params = np.array(result.params)
stderr = np.array(summarize(result)['std err'])
def conf_interval(params, stderr, x):
    low = np.dot((params - stderr), x)
    high = np.dot((params + stderr), x)
    return low, high

conf_interval(params, stderr, [1, 98])
</code></pre>
<pre><code>(23.003374498935447, 25.891374498935456)
</code></pre>
<pre><code class="language-python">pred = result.get_prediction([1, 98])
pred.conf_int(alpha=0.05)
</code></pre>
<pre><code>array([[23.947671, 24.947078]])
</code></pre>
<pre><code class="language-python">ax = plt.subplots(figsize=(8,8))[1]
ax.scatter(result.fittedvalues, result.resid)
ax.set_xlabel('Fitted value')
ax.set_ylabel('Residual')
ax.axhline(0, c='k', ls='--');
</code></pre>
<p><img alt="png" src="../Linear%20Regression%20sklearn_files/Linear%20Regression%20sklearn_11_0.png" /></p>
<pre><code class="language-python">df = df.drop(columns=['name'])
df.corr()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cylinders</th>
      <th>displacement</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>year</th>
      <th>origin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mpg</th>
      <td>1.000000</td>
      <td>-0.768159</td>
      <td>-0.803673</td>
      <td>-0.783845</td>
      <td>-0.832270</td>
      <td>0.383589</td>
      <td>0.568716</td>
      <td>0.555810</td>
    </tr>
    <tr>
      <th>cylinders</th>
      <td>-0.768159</td>
      <td>1.000000</td>
      <td>0.953304</td>
      <td>0.842559</td>
      <td>0.902638</td>
      <td>-0.449479</td>
      <td>-0.296280</td>
      <td>-0.554618</td>
    </tr>
    <tr>
      <th>displacement</th>
      <td>-0.803673</td>
      <td>0.953304</td>
      <td>1.000000</td>
      <td>0.884850</td>
      <td>0.946904</td>
      <td>-0.475429</td>
      <td>-0.315380</td>
      <td>-0.612197</td>
    </tr>
    <tr>
      <th>horsepower</th>
      <td>-0.783845</td>
      <td>0.842559</td>
      <td>0.884850</td>
      <td>1.000000</td>
      <td>0.880128</td>
      <td>-0.641154</td>
      <td>-0.370743</td>
      <td>-0.448932</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>-0.832270</td>
      <td>0.902638</td>
      <td>0.946904</td>
      <td>0.880128</td>
      <td>1.000000</td>
      <td>-0.381225</td>
      <td>-0.297841</td>
      <td>-0.578263</td>
    </tr>
    <tr>
      <th>acceleration</th>
      <td>0.383589</td>
      <td>-0.449479</td>
      <td>-0.475429</td>
      <td>-0.641154</td>
      <td>-0.381225</td>
      <td>1.000000</td>
      <td>0.205426</td>
      <td>0.179090</td>
    </tr>
    <tr>
      <th>year</th>
      <td>0.568716</td>
      <td>-0.296280</td>
      <td>-0.315380</td>
      <td>-0.370743</td>
      <td>-0.297841</td>
      <td>0.205426</td>
      <td>1.000000</td>
      <td>0.160888</td>
    </tr>
    <tr>
      <th>origin</th>
      <td>0.555810</td>
      <td>-0.554618</td>
      <td>-0.612197</td>
      <td>-0.448932</td>
      <td>-0.578263</td>
      <td>0.179090</td>
      <td>0.160888</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">X = MS(df.drop(columns=['mpg'])).fit_transform(df)
</code></pre>
<pre><code class="language-python">model = sm.OLS(df['mpg'], X)
result2 = model.fit()
summarize(result2)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>std err</th>
      <th>t</th>
      <th>P&gt;|t|</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>intercept</th>
      <td>-19.7169</td>
      <td>4.963</td>
      <td>-3.973</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>cylinders</th>
      <td>-0.4081</td>
      <td>0.349</td>
      <td>-1.170</td>
      <td>0.243</td>
    </tr>
    <tr>
      <th>displacement</th>
      <td>0.0168</td>
      <td>0.009</td>
      <td>1.963</td>
      <td>0.050</td>
    </tr>
    <tr>
      <th>horsepower</th>
      <td>-0.0174</td>
      <td>0.015</td>
      <td>-1.159</td>
      <td>0.247</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>-0.0063</td>
      <td>0.001</td>
      <td>-8.213</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>acceleration</th>
      <td>0.1110</td>
      <td>0.105</td>
      <td>1.059</td>
      <td>0.290</td>
    </tr>
    <tr>
      <th>year</th>
      <td>0.7734</td>
      <td>0.054</td>
      <td>14.294</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>origin</th>
      <td>1.3909</td>
      <td>0.285</td>
      <td>4.886</td>
      <td>0.000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">anova_lm(result, result2)
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>df_resid</th>
      <th>ssr</th>
      <th>df_diff</th>
      <th>ss_diff</th>
      <th>F</th>
      <th>Pr(&gt;F)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>370.0</td>
      <td>8778.242950</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>364.0</td>
      <td>4119.951551</td>
      <td>6.0</td>
      <td>4658.291399</td>
      <td>68.593771</td>
      <td>7.767048e-57</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">ax = plt.subplots(figsize=(8,8))[1]
ax.scatter(result2.fittedvalues, result2.resid)
ax.set_xlabel('Fitted value')
ax.set_ylabel('Residual')
ax.axhline(0, c='k', ls='--');
</code></pre>
<p><img alt="png" src="../Linear%20Regression%20sklearn_files/Linear%20Regression%20sklearn_16_0.png" /></p>
<pre><code class="language-python">vals = [VIF(X, i)
        for i in range(1, X.shape[1])]
vif = pd.DataFrame({'vif':vals},
                   index=X.columns[1:])
vif
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vif</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>cylinders</th>
      <td>11.149785</td>
    </tr>
    <tr>
      <th>displacement</th>
      <td>23.969825</td>
    </tr>
    <tr>
      <th>horsepower</th>
      <td>9.578183</td>
    </tr>
    <tr>
      <th>weight</th>
      <td>14.029209</td>
    </tr>
    <tr>
      <th>acceleration</th>
      <td>2.414266</td>
    </tr>
    <tr>
      <th>year</th>
      <td>1.177402</td>
    </tr>
    <tr>
      <th>origin</th>
      <td>1.745033</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">infl = result2.get_influence ()
ax = plt.subplots(figsize =(8 ,8))[1]
ax.scatter(np.arange(X.shape [0]), infl.hat_matrix_diag)
ax.set_xlabel('Index ')
ax.set_ylabel('Leverage ')
np.argmax(infl.hat_matrix_diag)
</code></pre>
<pre><code>8
</code></pre>
<p><img alt="png" src="../Linear%20Regression%20sklearn_files/Linear%20Regression%20sklearn_18_1.png" /></p>
<pre><code class="language-python">df.describe()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mpg</th>
      <th>cylinders</th>
      <th>displacement</th>
      <th>horsepower</th>
      <th>weight</th>
      <th>acceleration</th>
      <th>year</th>
      <th>origin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>372.000000</td>
      <td>372.000000</td>
      <td>372.000000</td>
      <td>372.000000</td>
      <td>372.000000</td>
      <td>372.000000</td>
      <td>372.000000</td>
      <td>372.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>23.760215</td>
      <td>5.384409</td>
      <td>188.114247</td>
      <td>102.037634</td>
      <td>2956.629032</td>
      <td>15.738441</td>
      <td>76.301075</td>
      <td>1.594086</td>
    </tr>
    <tr>
      <th>std</th>
      <td>7.833502</td>
      <td>1.672699</td>
      <td>99.994614</td>
      <td>36.079109</td>
      <td>850.155868</td>
      <td>2.590570</td>
      <td>3.502898</td>
      <td>0.810489</td>
    </tr>
    <tr>
      <th>min</th>
      <td>9.000000</td>
      <td>3.000000</td>
      <td>68.000000</td>
      <td>46.000000</td>
      <td>1613.000000</td>
      <td>9.500000</td>
      <td>70.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>17.600000</td>
      <td>4.000000</td>
      <td>100.250000</td>
      <td>75.000000</td>
      <td>2219.750000</td>
      <td>14.000000</td>
      <td>73.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>23.000000</td>
      <td>4.000000</td>
      <td>141.000000</td>
      <td>91.500000</td>
      <td>2750.000000</td>
      <td>15.500000</td>
      <td>76.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>29.575000</td>
      <td>6.000000</td>
      <td>258.000000</td>
      <td>115.250000</td>
      <td>3581.750000</td>
      <td>17.300000</td>
      <td>79.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>46.600000</td>
      <td>8.000000</td>
      <td>455.000000</td>
      <td>230.000000</td>
      <td>5140.000000</td>
      <td>24.800000</td>
      <td>82.000000</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">result2.rsquared
</code></pre>
<pre><code>0.8190301157401636
</code></pre>
<pre><code class="language-python">result.rsquared
</code></pre>
<pre><code>0.6144135213369303
</code></pre>
<pre><code class="language-python">
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tabs", "search.highlight", "content.code.annotate", "content.action.edit"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>